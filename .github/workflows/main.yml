name: CI

on: push

jobs:
  build_common:
    
    name: Build on Mac
    runs-on: macos-10.15
    
    steps:
    - uses: actions/checkout@v2
      
    - name: common_all
      run: |
        
        #Pre-reqs
        sh -c "$(curl -fsSL https://raw.githubusercontent.com/Linuxbrew/install/master/install.sh)"
        brew install node@10
        brew install fastlane
        sudo npm install -g cordova
        sudo npm install -g phonegap
        brew install git
        
        # DIR setup
        $PWD=BASE_HOME
        cd / && cd $BASE_HOME
        mkdir applications
        cd / && cd $BASE_HOME/applications
        
        # Git clone
        git clone https://${{ secrets.GITHUB_REPO_TOKEN }}@github.com/badsprad/testapp.git

    - name: common_mobile
      run: |

        # Cordova
        cd testapp
        echo 'LISTEN 2:' $PWD
        cordova telemetry off
        CORDOVA_APP_NAME="cordova"
        CORDOVA_APP_ID="com.testapp.domain"
        cordova create $CORDOVA_APP_NAME $CORDOVA_APP_ID
        cd $CORDOVA_APP_NAME
        cordova platform add ios
        #cordova platform add android
